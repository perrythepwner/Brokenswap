{"ast":null,"code":"import { __read } from \"tslib\";\nimport { logger, SentryError } from '@sentry/utils';\nimport { initAPIDetails } from './api';\nimport { IS_DEBUG_BUILD } from './flags';\nimport { createEventEnvelope, createSessionEnvelope } from './request';\nimport { NoopTransport } from './transports/noop';\n/**\n * This is the base implemention of a Backend.\n * @hidden\n */\nvar BaseBackend = /** @class */function () {\n  /** Creates a new backend instance. */\n  function BaseBackend(options) {\n    this._options = options;\n    if (!this._options.dsn) {\n      IS_DEBUG_BUILD && logger.warn('No DSN provided, backend will not do anything.');\n    }\n    this._transport = this._setupTransport();\n  }\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  BaseBackend.prototype.eventFromException = function (_exception, _hint) {\n    throw new SentryError('Backend has to implement `eventFromException` method');\n  };\n  /**\n   * @inheritDoc\n   */\n  BaseBackend.prototype.eventFromMessage = function (_message, _level, _hint) {\n    throw new SentryError('Backend has to implement `eventFromMessage` method');\n  };\n  /**\n   * @inheritDoc\n   */\n  BaseBackend.prototype.sendEvent = function (event) {\n    // TODO(v7): Remove the if-else\n    if (this._newTransport && this._options.dsn && this._options._experiments && this._options._experiments.newTransport) {\n      var api = initAPIDetails(this._options.dsn, this._options._metadata, this._options.tunnel);\n      var env = createEventEnvelope(event, api);\n      void this._newTransport.send(env).then(null, function (reason) {\n        IS_DEBUG_BUILD && logger.error('Error while sending event:', reason);\n      });\n    } else {\n      void this._transport.sendEvent(event).then(null, function (reason) {\n        IS_DEBUG_BUILD && logger.error('Error while sending event:', reason);\n      });\n    }\n  };\n  /**\n   * @inheritDoc\n   */\n  BaseBackend.prototype.sendSession = function (session) {\n    if (!this._transport.sendSession) {\n      IS_DEBUG_BUILD && logger.warn(\"Dropping session because custom transport doesn't implement sendSession\");\n      return;\n    }\n    // TODO(v7): Remove the if-else\n    if (this._newTransport && this._options.dsn && this._options._experiments && this._options._experiments.newTransport) {\n      var api = initAPIDetails(this._options.dsn, this._options._metadata, this._options.tunnel);\n      var _a = __read(createSessionEnvelope(session, api), 1),\n        env = _a[0];\n      void this._newTransport.send(env).then(null, function (reason) {\n        IS_DEBUG_BUILD && logger.error('Error while sending session:', reason);\n      });\n    } else {\n      void this._transport.sendSession(session).then(null, function (reason) {\n        IS_DEBUG_BUILD && logger.error('Error while sending session:', reason);\n      });\n    }\n  };\n  /**\n   * @inheritDoc\n   */\n  BaseBackend.prototype.getTransport = function () {\n    return this._transport;\n  };\n  /**\n   * Sets up the transport so it can be used later to send requests.\n   */\n  BaseBackend.prototype._setupTransport = function () {\n    return new NoopTransport();\n  };\n  return BaseBackend;\n}();\nexport { BaseBackend };","map":null,"metadata":{},"sourceType":"module"}