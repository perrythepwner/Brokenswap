{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decodeSig = exports.verifySignatureWithoutPrefix = exports.verifyEIP712TypedDataSigner = exports.recoverMessageSigner = exports.recoverTransaction = exports.extractSignature = exports.encodeTransaction = exports.rlpEncodedTx = exports.getHashFromEncoded = exports.chainIdTransformationForSigning = exports.thirtyTwo = exports.sixtyFour = exports.publicKeyPrefix = void 0;\nvar address_1 = require(\"@celo/base/lib/address\");\nvar formatter_1 = require(\"@celo/connect/lib/utils/formatter\");\nvar sign_typed_data_utils_1 = require(\"@celo/utils/lib/sign-typed-data-utils\");\nvar signatureUtils_1 = require(\"@celo/utils/lib/signatureUtils\");\nvar debug_1 = __importDefault(require(\"debug\"));\n// @ts-ignore-next-line\nvar eth_lib_1 = require(\"eth-lib\");\nvar ethUtil = __importStar(require(\"ethereumjs-util\"));\nvar debug = (0, debug_1.default)('wallet-base:tx:sign');\n// Original code taken from\n// https://github.com/ethereum/web3.js/blob/1.x/packages/web3-eth-accounts/src/index.js\n// 0x04 prefix indicates that the key is not compressed\n// https://tools.ietf.org/html/rfc5480#section-2.2\nexports.publicKeyPrefix = 0x04;\nexports.sixtyFour = 64;\nexports.thirtyTwo = 32;\nfunction isNullOrUndefined(value) {\n  return value === null || value === undefined;\n}\n// Simple replay attack protection\n// https://github.com/ethereum/EIPs/blob/master/EIPS/eip-155.md\nfunction chainIdTransformationForSigning(chainId) {\n  return chainId * 2 + 35;\n}\nexports.chainIdTransformationForSigning = chainIdTransformationForSigning;\nfunction getHashFromEncoded(rlpEncode) {\n  return eth_lib_1.hash.keccak256(rlpEncode);\n}\nexports.getHashFromEncoded = getHashFromEncoded;\nfunction trimLeadingZero(hex) {\n  while (hex && hex.startsWith('0x0')) {\n    hex = (0, address_1.ensureLeading0x)(hex.slice(3));\n  }\n  return hex;\n}\nfunction makeEven(hex) {\n  if (hex.length % 2 === 1) {\n    hex = hex.replace('0x', '0x0');\n  }\n  return hex;\n}\nfunction signatureFormatter(signature) {\n  return {\n    v: stringNumberToHex(signature.v),\n    r: makeEven(trimLeadingZero((0, address_1.ensureLeading0x)(signature.r.toString('hex')))),\n    s: makeEven(trimLeadingZero((0, address_1.ensureLeading0x)(signature.s.toString('hex'))))\n  };\n}\nfunction stringNumberToHex(num) {\n  var auxNumber = Number(num);\n  if (num === '0x' || num === undefined || auxNumber === 0) {\n    return '0x';\n  }\n  return eth_lib_1.bytes.fromNumber(auxNumber);\n}\nfunction rlpEncodedTx(tx) {\n  var _a, _b;\n  if (!tx.gas) {\n    throw new Error('\"gas\" is missing');\n  }\n  if (isNullOrUndefined(tx.chainId) || isNullOrUndefined(tx.gasPrice) || isNullOrUndefined(tx.nonce)) {\n    throw new Error('One of the values \"chainId\", \"gasPrice\", or \"nonce\" couldn\\'t be fetched: ' + JSON.stringify({\n      chainId: tx.chainId,\n      gasPrice: tx.gasPrice,\n      nonce: tx.nonce\n    }));\n  }\n  if (tx.nonce < 0 || tx.gas < 0 || tx.gasPrice < 0 || tx.chainId < 0) {\n    throw new Error('Gas, gasPrice, nonce or chainId is lower than 0');\n  }\n  var transaction = (0, formatter_1.inputCeloTxFormatter)(tx);\n  transaction.to = eth_lib_1.bytes.fromNat(tx.to || '0x').toLowerCase();\n  transaction.nonce = Number((tx.nonce !== '0x' ? tx.nonce : 0) || 0);\n  transaction.data = eth_lib_1.bytes.fromNat(tx.data || '0x').toLowerCase();\n  transaction.value = stringNumberToHex((_a = tx.value) === null || _a === void 0 ? void 0 : _a.toString());\n  transaction.feeCurrency = eth_lib_1.bytes.fromNat(tx.feeCurrency || '0x').toLowerCase();\n  transaction.gatewayFeeRecipient = eth_lib_1.bytes.fromNat(tx.gatewayFeeRecipient || '0x').toLowerCase();\n  transaction.gatewayFee = stringNumberToHex(tx.gatewayFee);\n  transaction.gasPrice = stringNumberToHex((_b = tx.gasPrice) === null || _b === void 0 ? void 0 : _b.toString());\n  transaction.gas = stringNumberToHex(tx.gas);\n  transaction.chainId = tx.chainId || 1;\n  // This order should match the order in Geth.\n  // https://github.com/celo-org/celo-blockchain/blob/027dba2e4584936cc5a8e8993e4e27d28d5247b8/core/types/transaction.go#L65\n  var rlpEncode = eth_lib_1.RLP.encode([stringNumberToHex(transaction.nonce), transaction.gasPrice, transaction.gas, transaction.feeCurrency, transaction.gatewayFeeRecipient, transaction.gatewayFee, transaction.to, transaction.value, transaction.data, stringNumberToHex(transaction.chainId), '0x', '0x']);\n  return {\n    transaction: transaction,\n    rlpEncode: rlpEncode\n  };\n}\nexports.rlpEncodedTx = rlpEncodedTx;\nfunction encodeTransaction(rlpEncoded, signature) {\n  return __awaiter(this, void 0, void 0, function () {\n    var sanitizedSignature, v, r, s, rawTx, rawTransaction, hash, result;\n    return __generator(this, function (_a) {\n      sanitizedSignature = signatureFormatter(signature);\n      v = sanitizedSignature.v;\n      r = sanitizedSignature.r;\n      s = sanitizedSignature.s;\n      rawTx = eth_lib_1.RLP.decode(rlpEncoded.rlpEncode).slice(0, 9).concat([v, r, s]);\n      rawTransaction = eth_lib_1.RLP.encode(rawTx);\n      hash = getHashFromEncoded(rawTransaction);\n      result = {\n        tx: {\n          nonce: rlpEncoded.transaction.nonce.toString(),\n          gasPrice: rlpEncoded.transaction.gasPrice.toString(),\n          gas: rlpEncoded.transaction.gas.toString(),\n          to: rlpEncoded.transaction.to.toString(),\n          value: rlpEncoded.transaction.value.toString(),\n          input: rlpEncoded.transaction.data,\n          feeCurrency: rlpEncoded.transaction.feeCurrency.toString(),\n          gatewayFeeRecipient: rlpEncoded.transaction.gatewayFeeRecipient.toString(),\n          gatewayFee: rlpEncoded.transaction.gatewayFee.toString(),\n          v: v,\n          r: r,\n          s: s,\n          hash: hash\n        },\n        raw: rawTransaction\n      };\n      return [2 /*return*/, result];\n    });\n  });\n}\nexports.encodeTransaction = encodeTransaction;\nfunction extractSignature(rawTx) {\n  var rawValues = eth_lib_1.RLP.decode(rawTx);\n  var r = rawValues[10];\n  var s = rawValues[11];\n  // Account.recover cannot handle canonicalized signatures\n  // A canonicalized signature may have the first byte removed if its value is 0\n  r = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(r).padStart(64, '0'));\n  s = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(s).padStart(64, '0'));\n  return {\n    v: rawValues[9],\n    r: r,\n    s: s\n  };\n}\nexports.extractSignature = extractSignature;\n// Recover transaction and sender address from a raw transaction.\n// This is used for testing.\nfunction recoverTransaction(rawTx) {\n  var rawValues = eth_lib_1.RLP.decode(rawTx);\n  debug('signing-utils@recoverTransaction: values are %s', rawValues);\n  var recovery = eth_lib_1.bytes.toNumber(rawValues[9]);\n  // tslint:disable-next-line:no-bitwise\n  var chainId = eth_lib_1.bytes.fromNumber(recovery - 35 >> 1);\n  var celoTx = {\n    nonce: rawValues[0].toLowerCase() === '0x' ? 0 : parseInt(rawValues[0], 16),\n    gasPrice: rawValues[1].toLowerCase() === '0x' ? 0 : parseInt(rawValues[1], 16),\n    gas: rawValues[2].toLowerCase() === '0x' ? 0 : parseInt(rawValues[2], 16),\n    feeCurrency: rawValues[3],\n    gatewayFeeRecipient: rawValues[4],\n    gatewayFee: rawValues[5],\n    to: rawValues[6],\n    value: rawValues[7],\n    data: rawValues[8],\n    chainId: chainId\n  };\n  var r = rawValues[10];\n  var s = rawValues[11];\n  // Account.recover cannot handle canonicalized signatures\n  // A canonicalized signature may have the first byte removed if its value is 0\n  r = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(r).padStart(64, '0'));\n  s = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(s).padStart(64, '0'));\n  var signature = eth_lib_1.account.encodeSignature([rawValues[9], r, s]);\n  var extraData = recovery < 35 ? [] : [chainId, '0x', '0x'];\n  var signingData = rawValues.slice(0, 9).concat(extraData);\n  var signingDataHex = eth_lib_1.RLP.encode(signingData);\n  var signer = eth_lib_1.account.recover(getHashFromEncoded(signingDataHex), signature);\n  return [celoTx, signer];\n}\nexports.recoverTransaction = recoverTransaction;\nfunction recoverMessageSigner(signingDataHex, signedData) {\n  var dataBuff = ethUtil.toBuffer(signingDataHex);\n  var msgHashBuff = ethUtil.hashPersonalMessage(dataBuff);\n  var signature = ethUtil.fromRpcSig(signedData);\n  var publicKey = ethUtil.ecrecover(msgHashBuff, signature.v, signature.r, signature.s);\n  var address = ethUtil.pubToAddress(publicKey, true);\n  return (0, address_1.ensureLeading0x)(address.toString('hex'));\n}\nexports.recoverMessageSigner = recoverMessageSigner;\nfunction verifyEIP712TypedDataSigner(typedData, signedData, expectedAddress) {\n  var dataBuff = (0, sign_typed_data_utils_1.generateTypedDataHash)(typedData);\n  var trimmedData = dataBuff.toString('hex');\n  return verifySignatureWithoutPrefix((0, address_1.ensureLeading0x)(trimmedData), signedData, expectedAddress);\n}\nexports.verifyEIP712TypedDataSigner = verifyEIP712TypedDataSigner;\nfunction verifySignatureWithoutPrefix(messageHash, signature, signer) {\n  try {\n    (0, signatureUtils_1.parseSignatureWithoutPrefix)(messageHash, signature, signer);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\nexports.verifySignatureWithoutPrefix = verifySignatureWithoutPrefix;\nfunction decodeSig(sig) {\n  var _a = eth_lib_1.account.decodeSignature(sig),\n    v = _a[0],\n    r = _a[1],\n    s = _a[2];\n  return {\n    v: parseInt(v, 16),\n    r: ethUtil.toBuffer(r),\n    s: ethUtil.toBuffer(s)\n  };\n}\nexports.decodeSig = decodeSig;","map":{"version":3,"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","op","TypeError","pop","length","push","__importDefault","exports","decodeSig","verifySignatureWithoutPrefix","verifyEIP712TypedDataSigner","recoverMessageSigner","recoverTransaction","extractSignature","encodeTransaction","rlpEncodedTx","getHashFromEncoded","chainIdTransformationForSigning","thirtyTwo","sixtyFour","publicKeyPrefix","address_1","require","formatter_1","sign_typed_data_utils_1","signatureUtils_1","debug_1","eth_lib_1","ethUtil","debug","default","isNullOrUndefined","chainId","rlpEncode","hash","keccak256","trimLeadingZero","hex","startsWith","ensureLeading0x","slice","makeEven","replace","signatureFormatter","signature","stringNumberToHex","r","toString","s","num","auxNumber","Number","bytes","fromNumber","tx","_a","_b","gas","Error","gasPrice","nonce","JSON","stringify","transaction","inputCeloTxFormatter","to","fromNat","toLowerCase","data","feeCurrency","gatewayFeeRecipient","gatewayFee","RLP","encode","rlpEncoded","sanitizedSignature","rawTx","rawTransaction","decode","concat","input","raw","rawValues","trimLeading0x","padStart","recovery","toNumber","celoTx","parseInt","account","encodeSignature","extraData","signingData","signingDataHex","signer","recover","signedData","dataBuff","toBuffer","msgHashBuff","hashPersonalMessage","fromRpcSig","publicKey","ecrecover","address","pubToAddress","typedData","expectedAddress","generateTypedDataHash","trimmedData","messageHash","parseSignatureWithoutPrefix","error","sig","decodeSignature"],"sources":["/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@celo/wallet-local/node_modules/@celo/wallet-base/lib/signing-utils.js"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.decodeSig = exports.verifySignatureWithoutPrefix = exports.verifyEIP712TypedDataSigner = exports.recoverMessageSigner = exports.recoverTransaction = exports.extractSignature = exports.encodeTransaction = exports.rlpEncodedTx = exports.getHashFromEncoded = exports.chainIdTransformationForSigning = exports.thirtyTwo = exports.sixtyFour = exports.publicKeyPrefix = void 0;\nvar address_1 = require(\"@celo/base/lib/address\");\nvar formatter_1 = require(\"@celo/connect/lib/utils/formatter\");\nvar sign_typed_data_utils_1 = require(\"@celo/utils/lib/sign-typed-data-utils\");\nvar signatureUtils_1 = require(\"@celo/utils/lib/signatureUtils\");\nvar debug_1 = __importDefault(require(\"debug\"));\n// @ts-ignore-next-line\nvar eth_lib_1 = require(\"eth-lib\");\nvar ethUtil = __importStar(require(\"ethereumjs-util\"));\nvar debug = (0, debug_1.default)('wallet-base:tx:sign');\n// Original code taken from\n// https://github.com/ethereum/web3.js/blob/1.x/packages/web3-eth-accounts/src/index.js\n// 0x04 prefix indicates that the key is not compressed\n// https://tools.ietf.org/html/rfc5480#section-2.2\nexports.publicKeyPrefix = 0x04;\nexports.sixtyFour = 64;\nexports.thirtyTwo = 32;\nfunction isNullOrUndefined(value) {\n    return value === null || value === undefined;\n}\n// Simple replay attack protection\n// https://github.com/ethereum/EIPs/blob/master/EIPS/eip-155.md\nfunction chainIdTransformationForSigning(chainId) {\n    return chainId * 2 + 35;\n}\nexports.chainIdTransformationForSigning = chainIdTransformationForSigning;\nfunction getHashFromEncoded(rlpEncode) {\n    return eth_lib_1.hash.keccak256(rlpEncode);\n}\nexports.getHashFromEncoded = getHashFromEncoded;\nfunction trimLeadingZero(hex) {\n    while (hex && hex.startsWith('0x0')) {\n        hex = (0, address_1.ensureLeading0x)(hex.slice(3));\n    }\n    return hex;\n}\nfunction makeEven(hex) {\n    if (hex.length % 2 === 1) {\n        hex = hex.replace('0x', '0x0');\n    }\n    return hex;\n}\nfunction signatureFormatter(signature) {\n    return {\n        v: stringNumberToHex(signature.v),\n        r: makeEven(trimLeadingZero((0, address_1.ensureLeading0x)(signature.r.toString('hex')))),\n        s: makeEven(trimLeadingZero((0, address_1.ensureLeading0x)(signature.s.toString('hex')))),\n    };\n}\nfunction stringNumberToHex(num) {\n    var auxNumber = Number(num);\n    if (num === '0x' || num === undefined || auxNumber === 0) {\n        return '0x';\n    }\n    return eth_lib_1.bytes.fromNumber(auxNumber);\n}\nfunction rlpEncodedTx(tx) {\n    var _a, _b;\n    if (!tx.gas) {\n        throw new Error('\"gas\" is missing');\n    }\n    if (isNullOrUndefined(tx.chainId) ||\n        isNullOrUndefined(tx.gasPrice) ||\n        isNullOrUndefined(tx.nonce)) {\n        throw new Error('One of the values \"chainId\", \"gasPrice\", or \"nonce\" couldn\\'t be fetched: ' +\n            JSON.stringify({ chainId: tx.chainId, gasPrice: tx.gasPrice, nonce: tx.nonce }));\n    }\n    if (tx.nonce < 0 || tx.gas < 0 || tx.gasPrice < 0 || tx.chainId < 0) {\n        throw new Error('Gas, gasPrice, nonce or chainId is lower than 0');\n    }\n    var transaction = (0, formatter_1.inputCeloTxFormatter)(tx);\n    transaction.to = eth_lib_1.bytes.fromNat(tx.to || '0x').toLowerCase();\n    transaction.nonce = Number((tx.nonce !== '0x' ? tx.nonce : 0) || 0);\n    transaction.data = eth_lib_1.bytes.fromNat(tx.data || '0x').toLowerCase();\n    transaction.value = stringNumberToHex((_a = tx.value) === null || _a === void 0 ? void 0 : _a.toString());\n    transaction.feeCurrency = eth_lib_1.bytes.fromNat(tx.feeCurrency || '0x').toLowerCase();\n    transaction.gatewayFeeRecipient = eth_lib_1.bytes.fromNat(tx.gatewayFeeRecipient || '0x').toLowerCase();\n    transaction.gatewayFee = stringNumberToHex(tx.gatewayFee);\n    transaction.gasPrice = stringNumberToHex((_b = tx.gasPrice) === null || _b === void 0 ? void 0 : _b.toString());\n    transaction.gas = stringNumberToHex(tx.gas);\n    transaction.chainId = tx.chainId || 1;\n    // This order should match the order in Geth.\n    // https://github.com/celo-org/celo-blockchain/blob/027dba2e4584936cc5a8e8993e4e27d28d5247b8/core/types/transaction.go#L65\n    var rlpEncode = eth_lib_1.RLP.encode([\n        stringNumberToHex(transaction.nonce),\n        transaction.gasPrice,\n        transaction.gas,\n        transaction.feeCurrency,\n        transaction.gatewayFeeRecipient,\n        transaction.gatewayFee,\n        transaction.to,\n        transaction.value,\n        transaction.data,\n        stringNumberToHex(transaction.chainId),\n        '0x',\n        '0x',\n    ]);\n    return { transaction: transaction, rlpEncode: rlpEncode };\n}\nexports.rlpEncodedTx = rlpEncodedTx;\nfunction encodeTransaction(rlpEncoded, signature) {\n    return __awaiter(this, void 0, void 0, function () {\n        var sanitizedSignature, v, r, s, rawTx, rawTransaction, hash, result;\n        return __generator(this, function (_a) {\n            sanitizedSignature = signatureFormatter(signature);\n            v = sanitizedSignature.v;\n            r = sanitizedSignature.r;\n            s = sanitizedSignature.s;\n            rawTx = eth_lib_1.RLP.decode(rlpEncoded.rlpEncode).slice(0, 9).concat([v, r, s]);\n            rawTransaction = eth_lib_1.RLP.encode(rawTx);\n            hash = getHashFromEncoded(rawTransaction);\n            result = {\n                tx: {\n                    nonce: rlpEncoded.transaction.nonce.toString(),\n                    gasPrice: rlpEncoded.transaction.gasPrice.toString(),\n                    gas: rlpEncoded.transaction.gas.toString(),\n                    to: rlpEncoded.transaction.to.toString(),\n                    value: rlpEncoded.transaction.value.toString(),\n                    input: rlpEncoded.transaction.data,\n                    feeCurrency: rlpEncoded.transaction.feeCurrency.toString(),\n                    gatewayFeeRecipient: rlpEncoded.transaction.gatewayFeeRecipient.toString(),\n                    gatewayFee: rlpEncoded.transaction.gatewayFee.toString(),\n                    v: v,\n                    r: r,\n                    s: s,\n                    hash: hash,\n                },\n                raw: rawTransaction,\n            };\n            return [2 /*return*/, result];\n        });\n    });\n}\nexports.encodeTransaction = encodeTransaction;\nfunction extractSignature(rawTx) {\n    var rawValues = eth_lib_1.RLP.decode(rawTx);\n    var r = rawValues[10];\n    var s = rawValues[11];\n    // Account.recover cannot handle canonicalized signatures\n    // A canonicalized signature may have the first byte removed if its value is 0\n    r = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(r).padStart(64, '0'));\n    s = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(s).padStart(64, '0'));\n    return {\n        v: rawValues[9],\n        r: r,\n        s: s,\n    };\n}\nexports.extractSignature = extractSignature;\n// Recover transaction and sender address from a raw transaction.\n// This is used for testing.\nfunction recoverTransaction(rawTx) {\n    var rawValues = eth_lib_1.RLP.decode(rawTx);\n    debug('signing-utils@recoverTransaction: values are %s', rawValues);\n    var recovery = eth_lib_1.bytes.toNumber(rawValues[9]);\n    // tslint:disable-next-line:no-bitwise\n    var chainId = eth_lib_1.bytes.fromNumber((recovery - 35) >> 1);\n    var celoTx = {\n        nonce: rawValues[0].toLowerCase() === '0x' ? 0 : parseInt(rawValues[0], 16),\n        gasPrice: rawValues[1].toLowerCase() === '0x' ? 0 : parseInt(rawValues[1], 16),\n        gas: rawValues[2].toLowerCase() === '0x' ? 0 : parseInt(rawValues[2], 16),\n        feeCurrency: rawValues[3],\n        gatewayFeeRecipient: rawValues[4],\n        gatewayFee: rawValues[5],\n        to: rawValues[6],\n        value: rawValues[7],\n        data: rawValues[8],\n        chainId: chainId,\n    };\n    var r = rawValues[10];\n    var s = rawValues[11];\n    // Account.recover cannot handle canonicalized signatures\n    // A canonicalized signature may have the first byte removed if its value is 0\n    r = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(r).padStart(64, '0'));\n    s = (0, address_1.ensureLeading0x)((0, address_1.trimLeading0x)(s).padStart(64, '0'));\n    var signature = eth_lib_1.account.encodeSignature([rawValues[9], r, s]);\n    var extraData = recovery < 35 ? [] : [chainId, '0x', '0x'];\n    var signingData = rawValues.slice(0, 9).concat(extraData);\n    var signingDataHex = eth_lib_1.RLP.encode(signingData);\n    var signer = eth_lib_1.account.recover(getHashFromEncoded(signingDataHex), signature);\n    return [celoTx, signer];\n}\nexports.recoverTransaction = recoverTransaction;\nfunction recoverMessageSigner(signingDataHex, signedData) {\n    var dataBuff = ethUtil.toBuffer(signingDataHex);\n    var msgHashBuff = ethUtil.hashPersonalMessage(dataBuff);\n    var signature = ethUtil.fromRpcSig(signedData);\n    var publicKey = ethUtil.ecrecover(msgHashBuff, signature.v, signature.r, signature.s);\n    var address = ethUtil.pubToAddress(publicKey, true);\n    return (0, address_1.ensureLeading0x)(address.toString('hex'));\n}\nexports.recoverMessageSigner = recoverMessageSigner;\nfunction verifyEIP712TypedDataSigner(typedData, signedData, expectedAddress) {\n    var dataBuff = (0, sign_typed_data_utils_1.generateTypedDataHash)(typedData);\n    var trimmedData = dataBuff.toString('hex');\n    return verifySignatureWithoutPrefix((0, address_1.ensureLeading0x)(trimmedData), signedData, expectedAddress);\n}\nexports.verifyEIP712TypedDataSigner = verifyEIP712TypedDataSigner;\nfunction verifySignatureWithoutPrefix(messageHash, signature, signer) {\n    try {\n        (0, signatureUtils_1.parseSignatureWithoutPrefix)(messageHash, signature, signer);\n        return true;\n    }\n    catch (error) {\n        return false;\n    }\n}\nexports.verifySignatureWithoutPrefix = verifySignatureWithoutPrefix;\nfunction decodeSig(sig) {\n    var _a = eth_lib_1.account.decodeSignature(sig), v = _a[0], r = _a[1], s = _a[2];\n    return {\n        v: parseInt(v, 16),\n        r: ethUtil.toBuffer(r),\n        s: ethUtil.toBuffer(s),\n    };\n}\nexports.decodeSig = decodeSig;\n//# sourceMappingURL=signing-utils.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}