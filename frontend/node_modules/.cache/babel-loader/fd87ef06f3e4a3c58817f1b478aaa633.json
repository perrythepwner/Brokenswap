{"ast":null,"code":"import _asyncToGenerator from \"/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport * as UbeswapDefaultList from '@ubeswap/default-token-list';\nimport * as UbeswapExperimentalList from '@ubeswap/default-token-list/ubeswap-experimental.token-list.json';\nimport { ChainId } from '@ubeswap/sdk';\nimport Vibrant from 'node-vibrant';\nimport { shade } from 'polished';\nimport { useLayoutEffect, useState } from 'react';\nimport { useTheme } from 'styled-components';\nimport uriToHttp from 'utils/uriToHttp';\nimport { hex } from 'wcag-contrast';\nconst images = {};\nUbeswapDefaultList.tokens.concat(UbeswapExperimentalList.tokens).forEach(token => {\n  images[token.address] = token.logoURI;\n});\nfunction getColorFromToken(_x) {\n  return _getColorFromToken.apply(this, arguments);\n}\nfunction _getColorFromToken() {\n  _getColorFromToken = _asyncToGenerator(function* (token) {\n    if (token.chainId === ChainId.ALFAJORES && token.address === '0xc7AD46e0b8a400Bb3C915120d284AafbA8fc4735') {\n      return Promise.resolve('#FAAB14');\n    }\n    const path = images[token.address];\n    if (!path) {\n      return '#FAAB14';\n    }\n    return Vibrant.from(path).getPalette().then(palette => {\n      if (palette !== null && palette !== void 0 && palette.Vibrant) {\n        let detectedHex = palette.Vibrant.hex;\n        let AAscore = hex(detectedHex, '#FFF');\n        while (AAscore < 3) {\n          detectedHex = shade(0.005, detectedHex);\n          AAscore = hex(detectedHex, '#FFF');\n        }\n        return detectedHex;\n      }\n      return null;\n    }).catch(() => null);\n  });\n  return _getColorFromToken.apply(this, arguments);\n}\nfunction getColorFromUriPath(_x2) {\n  return _getColorFromUriPath.apply(this, arguments);\n}\nfunction _getColorFromUriPath() {\n  _getColorFromUriPath = _asyncToGenerator(function* (uri) {\n    const formattedPath = uriToHttp(uri)[0];\n    return Vibrant.from(formattedPath).getPalette().then(palette => {\n      if (palette !== null && palette !== void 0 && palette.Vibrant) {\n        return palette.Vibrant.hex;\n      }\n      return null;\n    }).catch(() => null);\n  });\n  return _getColorFromUriPath.apply(this, arguments);\n}\nexport function useColor(token) {\n  _s();\n  const theme = useTheme();\n  const [color, setColor] = useState(theme.primary1);\n  useLayoutEffect(() => {\n    let stale = false;\n    if (token) {\n      getColorFromToken(token).then(tokenColor => {\n        if (!stale && tokenColor !== null) {\n          setColor(tokenColor);\n        }\n      });\n    }\n    return () => {\n      stale = true;\n      setColor('#2172E5');\n    };\n  }, [token]);\n  return color;\n}\n_s(useColor, \"zqwXAhxFdoPMl28mst32dPO0fXs=\", false, function () {\n  return [useTheme];\n});\nexport function useListColor(listImageUri) {\n  _s2();\n  const [color, setColor] = useState('#2172E5');\n  useLayoutEffect(() => {\n    let stale = false;\n    if (listImageUri) {\n      getColorFromUriPath(listImageUri).then(color => {\n        if (!stale && color !== null) {\n          setColor(color);\n        }\n      });\n    }\n    return () => {\n      stale = true;\n      setColor('#2172E5');\n    };\n  }, [listImageUri]);\n  return color;\n}\n_s2(useListColor, \"CqcsdXcHHe8YLCjEUB+BxKSpNlQ=\");","map":{"version":3,"names":["UbeswapDefaultList","UbeswapExperimentalList","ChainId","Vibrant","shade","useLayoutEffect","useState","useTheme","uriToHttp","hex","images","tokens","concat","forEach","token","address","logoURI","getColorFromToken","_x","_getColorFromToken","apply","arguments","_asyncToGenerator","chainId","ALFAJORES","Promise","resolve","path","from","getPalette","then","palette","detectedHex","AAscore","catch","getColorFromUriPath","_x2","_getColorFromUriPath","uri","formattedPath","useColor","_s","theme","color","setColor","primary1","stale","tokenColor","useListColor","listImageUri","_s2"],"sources":["/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/src/hooks/useColor.ts"],"sourcesContent":["import * as UbeswapDefaultList from '@ubeswap/default-token-list'\nimport * as UbeswapExperimentalList from '@ubeswap/default-token-list/ubeswap-experimental.token-list.json'\nimport { ChainId, Token } from '@ubeswap/sdk'\nimport Vibrant from 'node-vibrant'\nimport { shade } from 'polished'\nimport { useLayoutEffect, useState } from 'react'\nimport { useTheme } from 'styled-components'\nimport uriToHttp from 'utils/uriToHttp'\nimport { hex } from 'wcag-contrast'\n\nconst images: Record<string, string> = {}\n\nUbeswapDefaultList.tokens.concat(UbeswapExperimentalList.tokens).forEach((token) => {\n  images[token.address] = token.logoURI\n})\n\nasync function getColorFromToken(token: Token): Promise<string | null> {\n  if (token.chainId === ChainId.ALFAJORES && token.address === '0xc7AD46e0b8a400Bb3C915120d284AafbA8fc4735') {\n    return Promise.resolve('#FAAB14')\n  }\n\n  const path = images[token.address]\n  if (!path) {\n    return '#FAAB14'\n  }\n\n  return Vibrant.from(path)\n    .getPalette()\n    .then((palette) => {\n      if (palette?.Vibrant) {\n        let detectedHex = palette.Vibrant.hex\n        let AAscore = hex(detectedHex, '#FFF')\n        while (AAscore < 3) {\n          detectedHex = shade(0.005, detectedHex)\n          AAscore = hex(detectedHex, '#FFF')\n        }\n        return detectedHex\n      }\n      return null\n    })\n    .catch(() => null)\n}\n\nasync function getColorFromUriPath(uri: string): Promise<string | null> {\n  const formattedPath = uriToHttp(uri)[0]\n\n  return Vibrant.from(formattedPath)\n    .getPalette()\n    .then((palette) => {\n      if (palette?.Vibrant) {\n        return palette.Vibrant.hex\n      }\n      return null\n    })\n    .catch(() => null)\n}\n\nexport function useColor(token?: Token) {\n  const theme = useTheme()\n  const [color, setColor] = useState(theme.primary1)\n\n  useLayoutEffect(() => {\n    let stale = false\n\n    if (token) {\n      getColorFromToken(token).then((tokenColor) => {\n        if (!stale && tokenColor !== null) {\n          setColor(tokenColor)\n        }\n      })\n    }\n\n    return () => {\n      stale = true\n      setColor('#2172E5')\n    }\n  }, [token])\n\n  return color\n}\n\nexport function useListColor(listImageUri?: string) {\n  const [color, setColor] = useState('#2172E5')\n\n  useLayoutEffect(() => {\n    let stale = false\n\n    if (listImageUri) {\n      getColorFromUriPath(listImageUri).then((color) => {\n        if (!stale && color !== null) {\n          setColor(color)\n        }\n      })\n    }\n\n    return () => {\n      stale = true\n      setColor('#2172E5')\n    }\n  }, [listImageUri])\n\n  return color\n}\n"],"mappings":";;;AAAA,OAAO,KAAKA,kBAAkB,MAAM,6BAA6B;AACjE,OAAO,KAAKC,uBAAuB,MAAM,kEAAkE;AAC3G,SAASC,OAAO,QAAe,cAAc;AAC7C,OAAOC,OAAO,MAAM,cAAc;AAClC,SAASC,KAAK,QAAQ,UAAU;AAChC,SAASC,eAAe,EAAEC,QAAQ,QAAQ,OAAO;AACjD,SAASC,QAAQ,QAAQ,mBAAmB;AAC5C,OAAOC,SAAS,MAAM,iBAAiB;AACvC,SAASC,GAAG,QAAQ,eAAe;AAEnC,MAAMC,MAA8B,GAAG,CAAC,CAAC;AAEzCV,kBAAkB,CAACW,MAAM,CAACC,MAAM,CAACX,uBAAuB,CAACU,MAAM,CAAC,CAACE,OAAO,CAAEC,KAAK,IAAK;EAClFJ,MAAM,CAACI,KAAK,CAACC,OAAO,CAAC,GAAGD,KAAK,CAACE,OAAO;AACvC,CAAC,CAAC;AAAA,SAEaC,iBAAiBA,CAAAC,EAAA;EAAA,OAAAC,kBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAF,mBAAA;EAAAA,kBAAA,GAAAG,iBAAA,CAAhC,WAAiCR,KAAY,EAA0B;IACrE,IAAIA,KAAK,CAACS,OAAO,KAAKrB,OAAO,CAACsB,SAAS,IAAIV,KAAK,CAACC,OAAO,KAAK,4CAA4C,EAAE;MACzG,OAAOU,OAAO,CAACC,OAAO,CAAC,SAAS,CAAC;IACnC;IAEA,MAAMC,IAAI,GAAGjB,MAAM,CAACI,KAAK,CAACC,OAAO,CAAC;IAClC,IAAI,CAACY,IAAI,EAAE;MACT,OAAO,SAAS;IAClB;IAEA,OAAOxB,OAAO,CAACyB,IAAI,CAACD,IAAI,CAAC,CACtBE,UAAU,CAAC,CAAC,CACZC,IAAI,CAAEC,OAAO,IAAK;MACjB,IAAIA,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAE5B,OAAO,EAAE;QACpB,IAAI6B,WAAW,GAAGD,OAAO,CAAC5B,OAAO,CAACM,GAAG;QACrC,IAAIwB,OAAO,GAAGxB,GAAG,CAACuB,WAAW,EAAE,MAAM,CAAC;QACtC,OAAOC,OAAO,GAAG,CAAC,EAAE;UAClBD,WAAW,GAAG5B,KAAK,CAAC,KAAK,EAAE4B,WAAW,CAAC;UACvCC,OAAO,GAAGxB,GAAG,CAACuB,WAAW,EAAE,MAAM,CAAC;QACpC;QACA,OAAOA,WAAW;MACpB;MACA,OAAO,IAAI;IACb,CAAC,CAAC,CACDE,KAAK,CAAC,MAAM,IAAI,CAAC;EACtB,CAAC;EAAA,OAAAf,kBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAEcc,mBAAmBA,CAAAC,GAAA;EAAA,OAAAC,oBAAA,CAAAjB,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAgB,qBAAA;EAAAA,oBAAA,GAAAf,iBAAA,CAAlC,WAAmCgB,GAAW,EAA0B;IACtE,MAAMC,aAAa,GAAG/B,SAAS,CAAC8B,GAAG,CAAC,CAAC,CAAC,CAAC;IAEvC,OAAOnC,OAAO,CAACyB,IAAI,CAACW,aAAa,CAAC,CAC/BV,UAAU,CAAC,CAAC,CACZC,IAAI,CAAEC,OAAO,IAAK;MACjB,IAAIA,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAE5B,OAAO,EAAE;QACpB,OAAO4B,OAAO,CAAC5B,OAAO,CAACM,GAAG;MAC5B;MACA,OAAO,IAAI;IACb,CAAC,CAAC,CACDyB,KAAK,CAAC,MAAM,IAAI,CAAC;EACtB,CAAC;EAAA,OAAAG,oBAAA,CAAAjB,KAAA,OAAAC,SAAA;AAAA;AAED,OAAO,SAASmB,QAAQA,CAAC1B,KAAa,EAAE;EAAA2B,EAAA;EACtC,MAAMC,KAAK,GAAGnC,QAAQ,CAAC,CAAC;EACxB,MAAM,CAACoC,KAAK,EAAEC,QAAQ,CAAC,GAAGtC,QAAQ,CAACoC,KAAK,CAACG,QAAQ,CAAC;EAElDxC,eAAe,CAAC,MAAM;IACpB,IAAIyC,KAAK,GAAG,KAAK;IAEjB,IAAIhC,KAAK,EAAE;MACTG,iBAAiB,CAACH,KAAK,CAAC,CAACgB,IAAI,CAAEiB,UAAU,IAAK;QAC5C,IAAI,CAACD,KAAK,IAAIC,UAAU,KAAK,IAAI,EAAE;UACjCH,QAAQ,CAACG,UAAU,CAAC;QACtB;MACF,CAAC,CAAC;IACJ;IAEA,OAAO,MAAM;MACXD,KAAK,GAAG,IAAI;MACZF,QAAQ,CAAC,SAAS,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAAC9B,KAAK,CAAC,CAAC;EAEX,OAAO6B,KAAK;AACd;AAACF,EAAA,CAtBeD,QAAQ;EAAA,QACRjC,QAAQ;AAAA;AAuBxB,OAAO,SAASyC,YAAYA,CAACC,YAAqB,EAAE;EAAAC,GAAA;EAClD,MAAM,CAACP,KAAK,EAAEC,QAAQ,CAAC,GAAGtC,QAAQ,CAAC,SAAS,CAAC;EAE7CD,eAAe,CAAC,MAAM;IACpB,IAAIyC,KAAK,GAAG,KAAK;IAEjB,IAAIG,YAAY,EAAE;MAChBd,mBAAmB,CAACc,YAAY,CAAC,CAACnB,IAAI,CAAEa,KAAK,IAAK;QAChD,IAAI,CAACG,KAAK,IAAIH,KAAK,KAAK,IAAI,EAAE;UAC5BC,QAAQ,CAACD,KAAK,CAAC;QACjB;MACF,CAAC,CAAC;IACJ;IAEA,OAAO,MAAM;MACXG,KAAK,GAAG,IAAI;MACZF,QAAQ,CAAC,SAAS,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAACK,YAAY,CAAC,CAAC;EAElB,OAAON,KAAK;AACd;AAACO,GAAA,CArBeF,YAAY"},"metadata":{},"sourceType":"module"}