{"ast":null,"code":"import _asyncToGenerator from\"/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import*as UbeswapDefaultList from'@ubeswap/default-token-list';import*as UbeswapExperimentalList from'@ubeswap/default-token-list/ubeswap-experimental.token-list.json';import{ChainId}from'@ubeswap/sdk';import Vibrant from'node-vibrant';import{shade}from'polished';import{useLayoutEffect,useState}from'react';import{useTheme}from'styled-components';import uriToHttp from'utils/uriToHttp';import{hex}from'wcag-contrast';const images={};UbeswapDefaultList.tokens.concat(UbeswapExperimentalList.tokens).forEach(token=>{images[token.address]=token.logoURI;});function getColorFromToken(_x){return _getColorFromToken.apply(this,arguments);}function _getColorFromToken(){_getColorFromToken=_asyncToGenerator(function*(token){if(token.chainId===ChainId.ALFAJORES&&token.address==='0xc7AD46e0b8a400Bb3C915120d284AafbA8fc4735'){return Promise.resolve('#FAAB14');}const path=images[token.address];if(!path){return'#FAAB14';}return Vibrant.from(path).getPalette().then(palette=>{if(palette!==null&&palette!==void 0&&palette.Vibrant){let detectedHex=palette.Vibrant.hex;let AAscore=hex(detectedHex,'#FFF');while(AAscore<3){detectedHex=shade(0.005,detectedHex);AAscore=hex(detectedHex,'#FFF');}return detectedHex;}return null;}).catch(()=>null);});return _getColorFromToken.apply(this,arguments);}function getColorFromUriPath(_x2){return _getColorFromUriPath.apply(this,arguments);}function _getColorFromUriPath(){_getColorFromUriPath=_asyncToGenerator(function*(uri){const formattedPath=uriToHttp(uri)[0];return Vibrant.from(formattedPath).getPalette().then(palette=>{if(palette!==null&&palette!==void 0&&palette.Vibrant){return palette.Vibrant.hex;}return null;}).catch(()=>null);});return _getColorFromUriPath.apply(this,arguments);}export function useColor(token){const theme=useTheme();const[color,setColor]=useState(theme.primary1);useLayoutEffect(()=>{let stale=false;if(token){getColorFromToken(token).then(tokenColor=>{if(!stale&&tokenColor!==null){setColor(tokenColor);}});}return()=>{stale=true;setColor('#2172E5');};},[token]);return color;}export function useListColor(listImageUri){const[color,setColor]=useState('#2172E5');useLayoutEffect(()=>{let stale=false;if(listImageUri){getColorFromUriPath(listImageUri).then(color=>{if(!stale&&color!==null){setColor(color);}});}return()=>{stale=true;setColor('#2172E5');};},[listImageUri]);return color;}","map":{"version":3,"names":["UbeswapDefaultList","UbeswapExperimentalList","ChainId","Vibrant","shade","useLayoutEffect","useState","useTheme","uriToHttp","hex","images","tokens","concat","forEach","token","address","logoURI","getColorFromToken","_x","_getColorFromToken","apply","arguments","_asyncToGenerator","chainId","ALFAJORES","Promise","resolve","path","from","getPalette","then","palette","detectedHex","AAscore","catch","getColorFromUriPath","_x2","_getColorFromUriPath","uri","formattedPath","useColor","theme","color","setColor","primary1","stale","tokenColor","useListColor","listImageUri"],"sources":["/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/src/hooks/useColor.ts"],"sourcesContent":["import * as UbeswapDefaultList from '@ubeswap/default-token-list'\nimport * as UbeswapExperimentalList from '@ubeswap/default-token-list/ubeswap-experimental.token-list.json'\nimport { ChainId, Token } from '@ubeswap/sdk'\nimport Vibrant from 'node-vibrant'\nimport { shade } from 'polished'\nimport { useLayoutEffect, useState } from 'react'\nimport { useTheme } from 'styled-components'\nimport uriToHttp from 'utils/uriToHttp'\nimport { hex } from 'wcag-contrast'\n\nconst images: Record<string, string> = {}\n\nUbeswapDefaultList.tokens.concat(UbeswapExperimentalList.tokens).forEach((token) => {\n  images[token.address] = token.logoURI\n})\n\nasync function getColorFromToken(token: Token): Promise<string | null> {\n  if (token.chainId === ChainId.ALFAJORES && token.address === '0xc7AD46e0b8a400Bb3C915120d284AafbA8fc4735') {\n    return Promise.resolve('#FAAB14')\n  }\n\n  const path = images[token.address]\n  if (!path) {\n    return '#FAAB14'\n  }\n\n  return Vibrant.from(path)\n    .getPalette()\n    .then((palette) => {\n      if (palette?.Vibrant) {\n        let detectedHex = palette.Vibrant.hex\n        let AAscore = hex(detectedHex, '#FFF')\n        while (AAscore < 3) {\n          detectedHex = shade(0.005, detectedHex)\n          AAscore = hex(detectedHex, '#FFF')\n        }\n        return detectedHex\n      }\n      return null\n    })\n    .catch(() => null)\n}\n\nasync function getColorFromUriPath(uri: string): Promise<string | null> {\n  const formattedPath = uriToHttp(uri)[0]\n\n  return Vibrant.from(formattedPath)\n    .getPalette()\n    .then((palette) => {\n      if (palette?.Vibrant) {\n        return palette.Vibrant.hex\n      }\n      return null\n    })\n    .catch(() => null)\n}\n\nexport function useColor(token?: Token) {\n  const theme = useTheme()\n  const [color, setColor] = useState(theme.primary1)\n\n  useLayoutEffect(() => {\n    let stale = false\n\n    if (token) {\n      getColorFromToken(token).then((tokenColor) => {\n        if (!stale && tokenColor !== null) {\n          setColor(tokenColor)\n        }\n      })\n    }\n\n    return () => {\n      stale = true\n      setColor('#2172E5')\n    }\n  }, [token])\n\n  return color\n}\n\nexport function useListColor(listImageUri?: string) {\n  const [color, setColor] = useState('#2172E5')\n\n  useLayoutEffect(() => {\n    let stale = false\n\n    if (listImageUri) {\n      getColorFromUriPath(listImageUri).then((color) => {\n        if (!stale && color !== null) {\n          setColor(color)\n        }\n      })\n    }\n\n    return () => {\n      stale = true\n      setColor('#2172E5')\n    }\n  }, [listImageUri])\n\n  return color\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}