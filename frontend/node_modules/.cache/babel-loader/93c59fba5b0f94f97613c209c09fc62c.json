{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst base_1 = require(\"@celo/contractkit/lib/base\");\nconst mini_kit_1 = require(\"@celo/contractkit/lib/mini-kit\");\nconst wallet_sdk_1 = require(\"@coinbase/wallet-sdk\");\nconst constants_1 = require(\"../constants\");\nconst logger_1 = require(\"../utils/logger\");\nconst metamask_1 = require(\"../utils/metamask\");\nconst common_1 = require(\"./common\");\nclass CoinbaseWalletConnector extends common_1.AbstractConnector {\n  constructor(network, manualNetworkingMode, dapp) {\n    var _a, _b;\n    super();\n    this.network = network;\n    this.manualNetworkingMode = manualNetworkingMode;\n    this.initialised = false;\n    this.type = constants_1.WalletTypes.CoinbaseWallet;\n    this.feeCurrency = base_1.CeloContract.GoldToken;\n    this.provider = null;\n    this.onChainChanged = chainIdHex => {\n      const chainId = parseInt(chainIdHex, 16);\n      if (this.network.chainId !== chainId) {\n        this.emit(common_1.ConnectorEvents.WALLET_CHAIN_CHANGED, chainId);\n      }\n    };\n    this.onAccountsChanged = accounts => {\n      if (accounts[0]) {\n        this.kit.connection.defaultAccount = accounts[0];\n        this.emit(common_1.ConnectorEvents.ADDRESS_CHANGED, accounts[0]);\n      }\n    };\n    this.kit = (0, mini_kit_1.newKit)(network.rpcUrl);\n    const sdk = new wallet_sdk_1.CoinbaseWalletSDK({\n      appName: (_a = dapp === null || dapp === void 0 ? void 0 : dapp.name) !== null && _a !== void 0 ? _a : '',\n      appLogoUrl: (_b = dapp === null || dapp === void 0 ? void 0 : dapp.icon) !== null && _b !== void 0 ? _b : '',\n      reloadOnDisconnect: false,\n      diagnosticLogger: {\n        log: (e, p) => {\n          // this fixes the app trying to resurrect the cb connector after the wallet has initiated a disconnection as the sdk then reloads the page\n          if ('walletlink_sdk_metadata_destroyed' === e && (p === null || p === void 0 ? void 0 : p.alreadyDestroyed) === false) {\n            this.close();\n          }\n          (0, logger_1.getApplicationLogger)().debug('[coinbase-wallet] sdk event', e, 'properties', p);\n        }\n      }\n    });\n    this.provider = sdk.makeWeb3Provider(network.rpcUrl, network.chainId);\n  }\n  initialise() {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this.provider) {\n        throw new Error('Coinbase wallet provider not instantiated');\n      }\n      if (this.initialised) {\n        return this;\n      }\n      const {\n        default: Web3\n      } = yield Promise.resolve().then(() => __importStar(require('web3')));\n      const web3 = new Web3(this.provider);\n      const [defaultAccount] = yield this.provider.request({\n        method: 'eth_requestAccounts'\n      });\n      this.removeListeners();\n      try {\n        if (!this.manualNetworkingMode) {\n          yield (0, metamask_1.switchToNetwork)(this.network, this.provider, () => web3.eth.getChainId());\n        }\n      } catch (e) {\n        // if user rejects the switch it will throw but we dont want it to disrupt everything\n        // they different chain ids will be enough for dapp devs to decided to reprompt\n      }\n      const walletChainId = yield this.provider.request({\n        method: 'eth_chainId'\n      });\n      this.provider.on('chainChanged', this.onChainChanged);\n      this.provider.on('accountsChanged', this.onAccountsChanged);\n      this.newKit(web3, defaultAccount);\n      this.initialised = true;\n      this.emit(common_1.ConnectorEvents.CONNECTED, {\n        walletType: this.type,\n        walletChainId: parseInt(walletChainId, 16),\n        networkName: this.network.name,\n        address: defaultAccount\n      });\n      return this;\n    });\n  }\n  removeListeners() {\n    if (this.provider) {\n      this.provider.removeListener('chainChanged', this.onChainChanged);\n      this.provider.removeListener('accountsChanged', this.onAccountsChanged);\n    }\n  }\n  newKit(web3, defaultAccount) {\n    this.kit = (0, mini_kit_1.newKitFromWeb3)(web3);\n    this.kit.connection.defaultAccount = defaultAccount;\n    return this.kit;\n  }\n  supportsFeeCurrency() {\n    return false;\n  }\n  startNetworkChangeFromApp(network) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const web3 = this.kit.connection.web3;\n      yield (0, metamask_1.switchToNetwork)(network, this.provider, () => web3.eth.getChainId());\n      this.continueNetworkUpdateFromWallet(network);\n    });\n  }\n  // for when the wallet is already on the desired network and the kit / dapp need to catch up.\n  continueNetworkUpdateFromWallet(network) {\n    this.network = network; // must set to prevent loop\n    const web3 = this.kit.connection.web3;\n    this.newKit(web3, this.account); // kit caches things so it need to be recreated\n    this.emit(common_1.ConnectorEvents.NETWORK_CHANGED, network.name);\n  }\n  close() {\n    var _a, _b;\n    this.removeListeners();\n    try {\n      this.kit.connection.stop();\n    } catch (e) {\n      (0, logger_1.getApplicationLogger)().error('[methods.close] could not stop a already stopped CeloConnection', e);\n    }\n    this.disconnect();\n    if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.connected) {\n      // must be called last as it refreshes page which then starts the resurector if disconnect has not been called\n      void ((_b = this.provider) === null || _b === void 0 ? void 0 : _b.close());\n    }\n    return;\n  }\n}\nexports.default = CoinbaseWalletConnector;","map":{"version":3,"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","done","then","apply","exports","base_1","require","mini_kit_1","wallet_sdk_1","constants_1","logger_1","metamask_1","common_1","CoinbaseWalletConnector","AbstractConnector","constructor","network","manualNetworkingMode","dapp","_a","_b","initialised","type","WalletTypes","CoinbaseWallet","feeCurrency","CeloContract","GoldToken","provider","onChainChanged","chainIdHex","chainId","parseInt","emit","ConnectorEvents","WALLET_CHAIN_CHANGED","onAccountsChanged","accounts","kit","connection","defaultAccount","ADDRESS_CHANGED","newKit","rpcUrl","sdk","CoinbaseWalletSDK","appName","name","appLogoUrl","icon","reloadOnDisconnect","diagnosticLogger","log","p","alreadyDestroyed","close","getApplicationLogger","debug","makeWeb3Provider","initialise","Error","default","Web3","web3","request","method","removeListeners","switchToNetwork","eth","getChainId","walletChainId","on","CONNECTED","walletType","networkName","address","removeListener","newKitFromWeb3","supportsFeeCurrency","startNetworkChangeFromApp","continueNetworkUpdateFromWallet","account","NETWORK_CHANGED","stop","error","disconnect","connected"],"sources":["/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@celo/react-celo/lib/connectors/coinbase-wallet.js"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst base_1 = require(\"@celo/contractkit/lib/base\");\nconst mini_kit_1 = require(\"@celo/contractkit/lib/mini-kit\");\nconst wallet_sdk_1 = require(\"@coinbase/wallet-sdk\");\nconst constants_1 = require(\"../constants\");\nconst logger_1 = require(\"../utils/logger\");\nconst metamask_1 = require(\"../utils/metamask\");\nconst common_1 = require(\"./common\");\nclass CoinbaseWalletConnector extends common_1.AbstractConnector {\n    constructor(network, manualNetworkingMode, dapp) {\n        var _a, _b;\n        super();\n        this.network = network;\n        this.manualNetworkingMode = manualNetworkingMode;\n        this.initialised = false;\n        this.type = constants_1.WalletTypes.CoinbaseWallet;\n        this.feeCurrency = base_1.CeloContract.GoldToken;\n        this.provider = null;\n        this.onChainChanged = (chainIdHex) => {\n            const chainId = parseInt(chainIdHex, 16);\n            if (this.network.chainId !== chainId) {\n                this.emit(common_1.ConnectorEvents.WALLET_CHAIN_CHANGED, chainId);\n            }\n        };\n        this.onAccountsChanged = (accounts) => {\n            if (accounts[0]) {\n                this.kit.connection.defaultAccount = accounts[0];\n                this.emit(common_1.ConnectorEvents.ADDRESS_CHANGED, accounts[0]);\n            }\n        };\n        this.kit = (0, mini_kit_1.newKit)(network.rpcUrl);\n        const sdk = new wallet_sdk_1.CoinbaseWalletSDK({\n            appName: (_a = dapp === null || dapp === void 0 ? void 0 : dapp.name) !== null && _a !== void 0 ? _a : '',\n            appLogoUrl: (_b = dapp === null || dapp === void 0 ? void 0 : dapp.icon) !== null && _b !== void 0 ? _b : '',\n            reloadOnDisconnect: false,\n            diagnosticLogger: {\n                log: (e, p) => {\n                    // this fixes the app trying to resurrect the cb connector after the wallet has initiated a disconnection as the sdk then reloads the page\n                    if ('walletlink_sdk_metadata_destroyed' === e &&\n                        (p === null || p === void 0 ? void 0 : p.alreadyDestroyed) === false) {\n                        this.close();\n                    }\n                    (0, logger_1.getApplicationLogger)().debug('[coinbase-wallet] sdk event', e, 'properties', p);\n                },\n            },\n        });\n        this.provider = sdk.makeWeb3Provider(network.rpcUrl, network.chainId);\n    }\n    initialise() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.provider) {\n                throw new Error('Coinbase wallet provider not instantiated');\n            }\n            if (this.initialised) {\n                return this;\n            }\n            const { default: Web3 } = yield Promise.resolve().then(() => __importStar(require('web3')));\n            const web3 = new Web3(this.provider);\n            const [defaultAccount] = yield this.provider.request({\n                method: 'eth_requestAccounts',\n            });\n            this.removeListeners();\n            try {\n                if (!this.manualNetworkingMode) {\n                    yield (0, metamask_1.switchToNetwork)(this.network, this.provider, () => web3.eth.getChainId());\n                }\n            }\n            catch (e) {\n                // if user rejects the switch it will throw but we dont want it to disrupt everything\n                // they different chain ids will be enough for dapp devs to decided to reprompt\n            }\n            const walletChainId = yield this.provider.request({\n                method: 'eth_chainId',\n            });\n            this.provider.on('chainChanged', this.onChainChanged);\n            this.provider.on('accountsChanged', this.onAccountsChanged);\n            this.newKit(web3, defaultAccount);\n            this.initialised = true;\n            this.emit(common_1.ConnectorEvents.CONNECTED, {\n                walletType: this.type,\n                walletChainId: parseInt(walletChainId, 16),\n                networkName: this.network.name,\n                address: defaultAccount,\n            });\n            return this;\n        });\n    }\n    removeListeners() {\n        if (this.provider) {\n            this.provider.removeListener('chainChanged', this.onChainChanged);\n            this.provider.removeListener('accountsChanged', this.onAccountsChanged);\n        }\n    }\n    newKit(web3, defaultAccount) {\n        this.kit = (0, mini_kit_1.newKitFromWeb3)(web3);\n        this.kit.connection.defaultAccount = defaultAccount;\n        return this.kit;\n    }\n    supportsFeeCurrency() {\n        return false;\n    }\n    startNetworkChangeFromApp(network) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const web3 = this.kit.connection.web3;\n            yield (0, metamask_1.switchToNetwork)(network, this.provider, () => web3.eth.getChainId());\n            this.continueNetworkUpdateFromWallet(network);\n        });\n    }\n    // for when the wallet is already on the desired network and the kit / dapp need to catch up.\n    continueNetworkUpdateFromWallet(network) {\n        this.network = network; // must set to prevent loop\n        const web3 = this.kit.connection.web3;\n        this.newKit(web3, this.account); // kit caches things so it need to be recreated\n        this.emit(common_1.ConnectorEvents.NETWORK_CHANGED, network.name);\n    }\n    close() {\n        var _a, _b;\n        this.removeListeners();\n        try {\n            this.kit.connection.stop();\n        }\n        catch (e) {\n            (0, logger_1.getApplicationLogger)().error('[methods.close] could not stop a already stopped CeloConnection', e);\n        }\n        this.disconnect();\n        if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.connected) {\n            // must be called last as it refreshes page which then starts the resurector if disconnect has not been called\n            void ((_b = this.provider) === null || _b === void 0 ? void 0 : _b.close());\n        }\n        return;\n    }\n}\nexports.default = CoinbaseWalletConnector;\n//# sourceMappingURL=coinbase-wallet.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}