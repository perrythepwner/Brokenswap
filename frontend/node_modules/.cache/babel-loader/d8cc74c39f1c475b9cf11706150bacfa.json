{"ast":null,"code":"import _objectSpread from\"/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{MINIMA_ROUTER_ADDRESS}from'../../../../constants';import{MinimaRouter__factory}from'../../../../generated';/**\n * Executes a trade on Minima.\n * @param trade\n * @returns\n */export const executeMinimaTrade=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(function*(_ref){let{trade,signer,doTransaction,recipient,withRecipient}=_ref;const contract=MinimaRouter__factory.connect(MINIMA_ROUTER_ADDRESS,signer);const{details,inputAmount,outputAmount}=trade;const inputToken=inputAmount.token;const outputToken=outputAmount.token;const convert=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(function*(){var _inputToken$symbol,_outputToken$symbol;const inputSymbol=(_inputToken$symbol=inputToken.symbol)!==null&&_inputToken$symbol!==void 0?_inputToken$symbol:null;const outputSymbol=(_outputToken$symbol=outputToken.symbol)!==null&&_outputToken$symbol!==void 0?_outputToken$symbol:null;const tokenAmountIn=inputAmount.toSignificant(3);const tokenAmountOut=outputAmount.toSignificant(3);return yield doTransaction(contract,'swapExactInputForOutput',{args:[_objectSpread(_objectSpread({},details),{},{to:recipient!==null&&recipient!==void 0?recipient:''})],summary:\"Swap \".concat(tokenAmountIn,\" \").concat(inputSymbol,\" for \").concat(tokenAmountOut,\" \").concat(outputSymbol).concat(withRecipient),raw:trade===null||trade===void 0?void 0:trade.txn});});return function convert(){return _ref3.apply(this,arguments);};}();return{hash:(yield convert()).hash};});return function executeMinimaTrade(_x){return _ref2.apply(this,arguments);};}();","map":{"version":3,"names":["MINIMA_ROUTER_ADDRESS","MinimaRouter__factory","executeMinimaTrade","_ref2","_asyncToGenerator","_ref","trade","signer","doTransaction","recipient","withRecipient","contract","connect","details","inputAmount","outputAmount","inputToken","token","outputToken","convert","_ref3","_inputToken$symbol","_outputToken$symbol","inputSymbol","symbol","outputSymbol","tokenAmountIn","toSignificant","tokenAmountOut","args","_objectSpread","to","summary","concat","raw","txn","apply","arguments","hash","_x"],"sources":["/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/src/components/swap/routing/minima/executeMinimaTrade.ts"],"sourcesContent":["import { ContractTransaction } from 'ethers'\n\nimport { MINIMA_ROUTER_ADDRESS } from '../../../../constants'\nimport { MinimaRouter__factory } from '../../../../generated'\nimport { TradeExecutor } from '..'\nimport { MinimaRouterTrade } from '../trade'\n\n/**\n * Executes a trade on Minima.\n * @param trade\n * @returns\n */\nexport const executeMinimaTrade: TradeExecutor<MinimaRouterTrade> = async ({\n  trade,\n  signer,\n  doTransaction,\n  recipient,\n  withRecipient,\n}) => {\n  const contract = MinimaRouter__factory.connect(MINIMA_ROUTER_ADDRESS, signer)\n\n  const { details, inputAmount, outputAmount } = trade\n  const inputToken = inputAmount.token\n  const outputToken = outputAmount.token\n\n  const convert = async (): Promise<ContractTransaction> => {\n    const inputSymbol = inputToken.symbol ?? null\n    const outputSymbol = outputToken.symbol ?? null\n\n    const tokenAmountIn = inputAmount.toSignificant(3)\n    const tokenAmountOut = outputAmount.toSignificant(3)\n\n    return await doTransaction(contract, 'swapExactInputForOutput', {\n      args: [{ ...details, to: recipient ?? '' }],\n      summary: `Swap ${tokenAmountIn} ${inputSymbol} for ${tokenAmountOut} ${outputSymbol}${withRecipient}`,\n      raw: trade?.txn,\n    })\n  }\n\n  return { hash: (await convert()).hash }\n}\n"],"mappings":"6VAEA,OAASA,qBAAqB,KAAQ,uBAAuB,CAC7D,OAASC,qBAAqB,KAAQ,uBAAuB,CAI7D;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAC,kBAAoD,6BAAAC,KAAA,CAAAC,iBAAA,CAAG,UAAAC,IAAA,CAM9D,IANqE,CACzEC,KAAK,CACLC,MAAM,CACNC,aAAa,CACbC,SAAS,CACTC,aACF,CAAC,CAAAL,IAAA,CACC,KAAM,CAAAM,QAAQ,CAAGV,qBAAqB,CAACW,OAAO,CAACZ,qBAAqB,CAAEO,MAAM,CAAC,CAE7E,KAAM,CAAEM,OAAO,CAAEC,WAAW,CAAEC,YAAa,CAAC,CAAGT,KAAK,CACpD,KAAM,CAAAU,UAAU,CAAGF,WAAW,CAACG,KAAK,CACpC,KAAM,CAAAC,WAAW,CAAGH,YAAY,CAACE,KAAK,CAEtC,KAAM,CAAAE,OAAO,6BAAAC,KAAA,CAAAhB,iBAAA,CAAG,WAA0C,KAAAiB,kBAAA,CAAAC,mBAAA,CACxD,KAAM,CAAAC,WAAW,EAAAF,kBAAA,CAAGL,UAAU,CAACQ,MAAM,UAAAH,kBAAA,UAAAA,kBAAA,CAAI,IAAI,CAC7C,KAAM,CAAAI,YAAY,EAAAH,mBAAA,CAAGJ,WAAW,CAACM,MAAM,UAAAF,mBAAA,UAAAA,mBAAA,CAAI,IAAI,CAE/C,KAAM,CAAAI,aAAa,CAAGZ,WAAW,CAACa,aAAa,CAAC,CAAC,CAAC,CAClD,KAAM,CAAAC,cAAc,CAAGb,YAAY,CAACY,aAAa,CAAC,CAAC,CAAC,CAEpD,YAAa,CAAAnB,aAAa,CAACG,QAAQ,CAAE,yBAAyB,CAAE,CAC9DkB,IAAI,CAAE,CAAAC,aAAA,CAAAA,aAAA,IAAMjB,OAAO,MAAEkB,EAAE,CAAEtB,SAAS,SAATA,SAAS,UAATA,SAAS,CAAI,EAAE,GAAG,CAC3CuB,OAAO,SAAAC,MAAA,CAAUP,aAAa,MAAAO,MAAA,CAAIV,WAAW,UAAAU,MAAA,CAAQL,cAAc,MAAAK,MAAA,CAAIR,YAAY,EAAAQ,MAAA,CAAGvB,aAAa,CAAE,CACrGwB,GAAG,CAAE5B,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAE6B,GACd,CAAC,CAAC,CACJ,CAAC,iBAZK,CAAAhB,OAAOA,CAAA,SAAAC,KAAA,CAAAgB,KAAA,MAAAC,SAAA,OAYZ,CAED,MAAO,CAAEC,IAAI,CAAE,MAAO,CAAAnB,OAAO,CAAC,CAAC,EAAEmB,IAAK,CAAC,CACzC,CAAC,iBA5BY,CAAApC,kBAAoDA,CAAAqC,EAAA,SAAApC,KAAA,CAAAiC,KAAA,MAAAC,SAAA,OA4BhE"},"metadata":{},"sourceType":"module"}