{"ast":null,"code":"import _taggedTemplateLiteral from\"/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11;import{useCelo}from'@celo/react-celo';import React,{useContext,useMemo}from'react';import{Link}from'react-router-dom';import{Text}from'rebass';import styled,{ThemeContext}from'styled-components';import{ButtonPrimary,ButtonSecondary}from'../../components/Button';import Card from'../../components/Card';import{AutoColumn}from'../../components/Column';import{CardNoise,CardSection,DataCard}from'../../components/earn/styled';import{SwapPoolTabs}from'../../components/NavigationTabs';import FullPositionCard from'../../components/PositionCard';import{RowBetween,RowFixed}from'../../components/Row';import{Dots}from'../../components/swap/styleds';import{usePairs}from'../../data/Reserves';import{toV2LiquidityToken,useTrackedTokenPairs}from'../../state/user/hooks';import{useTokenBalancesWithLoadingIndicator}from'../../state/wallet/hooks';import{ExternalLink,HideSmall,StyledInternalLink,TYPE}from'../../theme';import LiquidityWarning from'./LiquidityWarning';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const PageWrapper=styled(AutoColumn)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  max-width: 640px;\\n  width: 100%;\\n\"])));const VoteCard=styled(DataCard)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  background: radial-gradient(76.02% 75.41% at 1.84% 0%, #27ae60 0%, #222 100%);\\n  overflow: hidden;\\n\"])));const TitleRow=styled(RowBetween)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  \",\";\\n\"])),_ref=>{let{theme}=_ref;return theme.mediaWidth.upToSmall(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n    flex-wrap: wrap;\\n    gap: 12px;\\n    width: 100%;\\n    flex-direction: column-reverse;\\n  \"])));});const ButtonRow=styled(RowFixed)(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  gap: 8px;\\n  \",\";\\n\"])),_ref2=>{let{theme}=_ref2;return theme.mediaWidth.upToSmall(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n    width: 100%;\\n    flex-direction: row-reverse;\\n    justify-content: space-between;\\n  \"])));});const ResponsiveButtonPrimary=styled(ButtonPrimary)(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  width: fit-content;\\n  \",\";\\n\"])),_ref3=>{let{theme}=_ref3;return theme.mediaWidth.upToSmall(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n    width: 48%;\\n  \"])));});const ResponsiveButtonSecondary=styled(ButtonSecondary)(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  width: fit-content;\\n  \",\";\\n\"])),_ref4=>{let{theme}=_ref4;return theme.mediaWidth.upToSmall(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n    width: 48%;\\n  \"])));});const EmptyProposals=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  border: 1px solid \",\";\\n  padding: 16px 12px;\\n  border-radius: 12px;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n\"])),_ref5=>{let{theme}=_ref5;return theme.text4;});export default function Pool(){const theme=useContext(ThemeContext);const{address:account}=useCelo();// fetch the user's balances of all tracked V2 LP tokens\nconst trackedTokenPairs=useTrackedTokenPairs();const tokenPairsWithLiquidityTokens=useMemo(()=>trackedTokenPairs.map(tokens=>({liquidityToken:toV2LiquidityToken(tokens),tokens})),[trackedTokenPairs]);const liquidityTokens=useMemo(()=>tokenPairsWithLiquidityTokens.map(tpwlt=>tpwlt.liquidityToken),[tokenPairsWithLiquidityTokens]);const[v2PairsBalances,fetchingV2PairBalances]=useTokenBalancesWithLoadingIndicator(account!==null&&account!==void 0?account:undefined,liquidityTokens);// fetch the reserves for all V2 pools in which the user has a balance\nconst liquidityTokensWithBalances=useMemo(()=>tokenPairsWithLiquidityTokens.filter(_ref6=>{var _v2PairsBalances$liqu;let{liquidityToken}=_ref6;return(_v2PairsBalances$liqu=v2PairsBalances[liquidityToken.address])===null||_v2PairsBalances$liqu===void 0?void 0:_v2PairsBalances$liqu.greaterThan('0');}).map(_ref7=>{let{tokens}=_ref7;return tokens;}),[tokenPairsWithLiquidityTokens,v2PairsBalances]);const v2Pairs=usePairs(liquidityTokensWithBalances);const v2IsLoading=fetchingV2PairBalances||(v2Pairs===null||v2Pairs===void 0?void 0:v2Pairs.length)<liquidityTokensWithBalances.length||(v2Pairs===null||v2Pairs===void 0?void 0:v2Pairs.some(V2Pair=>!V2Pair));const allV2PairsWithLiquidity=v2Pairs.map(_ref8=>{let[,pair]=_ref8;return pair;}).filter(v2Pair=>Boolean(v2Pair));return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(PageWrapper,{children:[/*#__PURE__*/_jsx(LiquidityWarning,{}),/*#__PURE__*/_jsx(SwapPoolTabs,{active:'pool'}),/*#__PURE__*/_jsxs(VoteCard,{children:[/*#__PURE__*/_jsx(CardNoise,{}),/*#__PURE__*/_jsx(CardSection,{children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",children:[/*#__PURE__*/_jsx(RowBetween,{children:/*#__PURE__*/_jsx(TYPE.white,{fontWeight:600,children:'Liquidity provider rewards'})}),/*#__PURE__*/_jsx(RowBetween,{children:/*#__PURE__*/_jsx(TYPE.white,{fontSize:14,children:'Liquidity providers earn a 0.25% fee on all trades proportional to their share of the pool. Fees are added to the pool, accrue in real time and can be claimed by withdrawing your liquidity.'})}),/*#__PURE__*/_jsx(ExternalLink,{style:{color:'white',textDecoration:'underline'},target:\"_blank\",href:\"https://docs.ubeswap.org/tutorial/providing-liquidity\",children:/*#__PURE__*/_jsx(TYPE.white,{fontSize:14,children:'Read more about providing liquidity'})})]})}),/*#__PURE__*/_jsx(CardNoise,{})]}),/*#__PURE__*/_jsx(AutoColumn,{gap:\"lg\",justify:\"center\",children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",style:{width:'100%'},children:[/*#__PURE__*/_jsxs(TitleRow,{style:{marginTop:'1rem'},padding:'0',children:[/*#__PURE__*/_jsx(HideSmall,{children:/*#__PURE__*/_jsx(TYPE.mediumHeader,{style:{marginTop:'0.5rem',justifySelf:'flex-start'},children:'Your liquidity'})}),/*#__PURE__*/_jsxs(ButtonRow,{children:[/*#__PURE__*/_jsx(ResponsiveButtonSecondary,{as:Link,padding:\"6px 8px\",to:\"/create/ETH\",children:'Create a pair'}),/*#__PURE__*/_jsx(ResponsiveButtonPrimary,{id:\"join-pool-button\",as:Link,padding:\"6px 8px\",borderRadius:\"12px\",to:\"/add/ETH\",children:/*#__PURE__*/_jsx(Text,{fontWeight:500,fontSize:16,children:'Add Liquidity'})})]})]}),!account?/*#__PURE__*/_jsx(Card,{padding:\"40px\",children:/*#__PURE__*/_jsx(TYPE.body,{color:theme.text3,textAlign:\"center\",children:\"Connect to a wallet to view your liquidity.\"})}):v2IsLoading?/*#__PURE__*/_jsx(EmptyProposals,{children:/*#__PURE__*/_jsx(TYPE.body,{color:theme.text3,textAlign:\"center\",children:/*#__PURE__*/_jsx(Dots,{children:\"Loading\"})})}):(allV2PairsWithLiquidity===null||allV2PairsWithLiquidity===void 0?void 0:allV2PairsWithLiquidity.length)>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ButtonSecondary,{children:/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ExternalLink,{href:'https://info.ubeswap.org/account/'+account,children:\"Account analytics and accrued fees\"}),/*#__PURE__*/_jsx(\"span\",{children:\" \\u2197\"})]})}),allV2PairsWithLiquidity.map(v2Pair=>/*#__PURE__*/_jsx(FullPositionCard,{pair:v2Pair},v2Pair.liquidityToken.address))]}):/*#__PURE__*/_jsx(EmptyProposals,{children:/*#__PURE__*/_jsx(TYPE.body,{color:theme.text3,textAlign:\"center\",children:\"No liquidity found.\"})}),/*#__PURE__*/_jsx(AutoColumn,{justify:'center',gap:\"md\",children:/*#__PURE__*/_jsxs(Text,{textAlign:\"center\",fontSize:14,style:{padding:'.5rem 0 .5rem 0'},children:[\"Don't see a pool you joined?\",' ',/*#__PURE__*/_jsx(StyledInternalLink,{id:\"import-pool-link\",to:'/find',children:'Import it.'})]})})]})})]})});}","map":null,"metadata":{},"sourceType":"module"}