{"ast":null,"code":"import _asyncToGenerator from\"/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useCelo}from'@celo/react-celo';import{CELO,cUSD,Fraction,TokenAmount,TradeType}from'@ubeswap/sdk';import{ErrorText}from'components/swap/styleds';import{usePair}from'data/Reserves';import{BigNumber}from'ethers';import React,{useContext,useEffect,useState}from'react';import{ThemeContext}from'styled-components';import{TYPE}from'../../../../theme';import QuestionHelper from'../../../QuestionHelper';import{RowBetween,RowFixed}from'../../../Row';import{useLendingPool}from'../moola/useMoola';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const MoolaDirectTradeDetails=_ref=>{let{trade}=_ref;const{address:account,network}=useCelo();const chainId=network.chainId;const lendingPool=useLendingPool();const theme=useContext(ThemeContext);const celo=CELO[chainId];const[,pair]=usePair(celo,cUSD[chainId]);const cusdPrice=pair===null||pair===void 0?void 0:pair.priceOf(cUSD[chainId]);const[userData,setUserData]=useState(null);useEffect(()=>{if(account){;_asyncToGenerator(function*(){const data=yield lendingPool.getUserAccountData(account);setUserData(data);})();}},[account,lendingPool]);let userDataArea=null;if(userData){const healthFactor=userData.healthFactor.div(BigNumber.from(10).pow(27));const collateral=cusdPrice?new TokenAmount(celo,userData.totalCollateralETH.toString()).multiply(cusdPrice):null;const borrows=cusdPrice?new TokenAmount(celo,userData.totalDebtETH.toString()).multiply(cusdPrice):null;userDataArea=/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(TYPE.black,{color:theme.text2,fontSize:14,fontWeight:400,children:\"Collateral Balance\"}),/*#__PURE__*/_jsx(QuestionHelper,{text:\"The amount of collateral you have in Moola.\"})]}),/*#__PURE__*/_jsx(RowFixed,{children:/*#__PURE__*/_jsx(TYPE.black,{fontSize:14,marginLeft:'4px',children:collateral?collateral.lessThan(new Fraction('1'))?'<$1':\"$\".concat(collateral.toFixed(2)):'--'})})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(TYPE.black,{color:theme.text2,fontSize:14,fontWeight:400,children:\"Borrow Balance\"}),/*#__PURE__*/_jsx(QuestionHelper,{text:\"The amount you owe to Moola.\"})]}),/*#__PURE__*/_jsx(RowFixed,{children:/*#__PURE__*/_jsx(TYPE.black,{fontSize:14,marginLeft:'4px',children:borrows?borrows.lessThan(new Fraction('1'))?'<$1':\"$\".concat(borrows.toFixed(2)):'--'})})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(TYPE.black,{color:theme.text2,fontSize:14,fontWeight:400,children:\"Health Factor\"}),/*#__PURE__*/_jsx(QuestionHelper,{text:\"How risky your position is. If this is below 1, you can be liquidated.\"})]}),/*#__PURE__*/_jsx(ErrorText,{fontWeight:500,fontSize:14,severity:0,children:healthFactor.gt(100)?'Excellent':healthFactor.toString()})]})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsxs(TYPE.black,{fontSize:14,fontWeight:400,color:theme.text2,children:[trade.outputAmount.currency.symbol,\" received\"]}),/*#__PURE__*/_jsx(QuestionHelper,{text:\"Since this trade is routed through Moola, you are guaranteed to receive 1 \".concat(trade.outputAmount.currency.symbol,\" per \").concat(trade.inputAmount.currency.symbol,\".\")})]}),/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(TYPE.black,{fontSize:14,children:trade.outputAmount.lessThan('10000')?trade.outputAmount.toSignificant(4):trade.outputAmount.toFixed(0)}),/*#__PURE__*/_jsx(TYPE.black,{fontSize:14,marginLeft:'4px',children:trade.tradeType===TradeType.EXACT_INPUT?trade.outputAmount.currency.symbol:trade.inputAmount.currency.symbol})]})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(TYPE.black,{color:theme.text2,fontSize:14,fontWeight:400,children:\"Price Impact\"}),/*#__PURE__*/_jsx(QuestionHelper,{text:\"Since this trade is routed through Moola, there is zero price slippage.\"})]}),/*#__PURE__*/_jsx(ErrorText,{fontWeight:500,fontSize:14,severity:0,children:\"0.00%\"})]}),userDataArea]});};","map":{"version":3,"names":["useCelo","CELO","cUSD","Fraction","TokenAmount","TradeType","ErrorText","usePair","BigNumber","React","useContext","useEffect","useState","ThemeContext","TYPE","QuestionHelper","RowBetween","RowFixed","useLendingPool","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MoolaDirectTradeDetails","_ref","trade","address","account","network","chainId","lendingPool","theme","celo","pair","cusdPrice","priceOf","userData","setUserData","_asyncToGenerator","data","getUserAccountData","userDataArea","healthFactor","div","from","pow","collateral","totalCollateralETH","toString","multiply","borrows","totalDebtETH","children","black","color","text2","fontSize","fontWeight","text","marginLeft","lessThan","concat","toFixed","severity","gt","outputAmount","currency","symbol","inputAmount","toSignificant","tradeType","EXACT_INPUT"],"sources":["/home/simone/Scrivania/progetti/HTB_challs/HackTheBoo_23/VeryEasy2/Brokenswap/frontend/src/components/swap/routing/TradeDetails/MoolaDirectTradeDetails.tsx"],"sourcesContent":["import { useCelo } from '@celo/react-celo'\nimport { CELO, ChainId as UbeswapChainId, cUSD, Fraction, TokenAmount, TradeType } from '@ubeswap/sdk'\nimport { ErrorText } from 'components/swap/styleds'\nimport { usePair } from 'data/Reserves'\nimport { BigNumber } from 'ethers'\nimport React, { useContext, useEffect, useState } from 'react'\nimport { ThemeContext } from 'styled-components'\n\nimport { TYPE } from '../../../../theme'\nimport QuestionHelper from '../../../QuestionHelper'\nimport { RowBetween, RowFixed } from '../../../Row'\nimport { MoolaDirectTrade } from '../moola/MoolaDirectTrade'\nimport { useLendingPool } from '../moola/useMoola'\n\ninterface Props {\n  trade: MoolaDirectTrade\n}\n\nexport const MoolaDirectTradeDetails: React.FC<Props> = ({ trade }: Props) => {\n  const { address: account, network } = useCelo()\n  const chainId = network.chainId\n  const lendingPool = useLendingPool()\n  const theme = useContext(ThemeContext)\n\n  const celo = CELO[chainId as unknown as UbeswapChainId]\n  const [, pair] = usePair(celo, cUSD[chainId as unknown as UbeswapChainId])\n  const cusdPrice = pair?.priceOf(cUSD[chainId as unknown as UbeswapChainId])\n\n  const [userData, setUserData] = useState<{\n    totalCollateralETH: BigNumber\n    totalDebtETH: BigNumber\n    availableBorrowsETH: BigNumber\n    currentLiquidationThreshold: BigNumber\n    ltv: BigNumber\n    healthFactor: BigNumber\n  } | null>(null)\n  useEffect(() => {\n    if (account) {\n      ;(async () => {\n        const data = await lendingPool.getUserAccountData(account)\n        setUserData(data)\n      })()\n    }\n  }, [account, lendingPool])\n\n  let userDataArea = null\n  if (userData) {\n    const healthFactor = userData.healthFactor.div(BigNumber.from(10).pow(27))\n    const collateral = cusdPrice\n      ? new TokenAmount(celo, userData.totalCollateralETH.toString()).multiply(cusdPrice)\n      : null\n    const borrows = cusdPrice ? new TokenAmount(celo, userData.totalDebtETH.toString()).multiply(cusdPrice) : null\n\n    userDataArea = (\n      <>\n        <RowBetween>\n          <RowFixed>\n            <TYPE.black color={theme.text2} fontSize={14} fontWeight={400}>\n              Collateral Balance\n            </TYPE.black>\n            <QuestionHelper text=\"The amount of collateral you have in Moola.\" />\n          </RowFixed>\n          <RowFixed>\n            <TYPE.black fontSize={14} marginLeft={'4px'}>\n              {collateral ? (collateral.lessThan(new Fraction('1')) ? '<$1' : `$${collateral.toFixed(2)}`) : '--'}\n            </TYPE.black>\n          </RowFixed>\n        </RowBetween>\n        <RowBetween>\n          <RowFixed>\n            <TYPE.black color={theme.text2} fontSize={14} fontWeight={400}>\n              Borrow Balance\n            </TYPE.black>\n            <QuestionHelper text=\"The amount you owe to Moola.\" />\n          </RowFixed>\n          <RowFixed>\n            <TYPE.black fontSize={14} marginLeft={'4px'}>\n              {borrows ? (borrows.lessThan(new Fraction('1')) ? '<$1' : `$${borrows.toFixed(2)}`) : '--'}\n            </TYPE.black>\n          </RowFixed>\n        </RowBetween>\n        <RowBetween>\n          <RowFixed>\n            <TYPE.black color={theme.text2} fontSize={14} fontWeight={400}>\n              Health Factor\n            </TYPE.black>\n            <QuestionHelper text=\"How risky your position is. If this is below 1, you can be liquidated.\" />\n          </RowFixed>\n          <ErrorText fontWeight={500} fontSize={14} severity={0}>\n            {healthFactor.gt(100) ? 'Excellent' : healthFactor.toString()}\n          </ErrorText>\n        </RowBetween>\n      </>\n    )\n  }\n\n  return (\n    <>\n      <RowBetween>\n        <RowFixed>\n          <TYPE.black fontSize={14} fontWeight={400} color={theme.text2}>\n            {trade.outputAmount.currency.symbol} received\n          </TYPE.black>\n          <QuestionHelper\n            text={`Since this trade is routed through Moola, you are guaranteed to receive 1 ${trade.outputAmount.currency.symbol} per ${trade.inputAmount.currency.symbol}.`}\n          />\n        </RowFixed>\n        <RowFixed>\n          <TYPE.black fontSize={14}>\n            {trade.outputAmount.lessThan('10000') ? trade.outputAmount.toSignificant(4) : trade.outputAmount.toFixed(0)}\n          </TYPE.black>\n          <TYPE.black fontSize={14} marginLeft={'4px'}>\n            {trade.tradeType === TradeType.EXACT_INPUT\n              ? trade.outputAmount.currency.symbol\n              : trade.inputAmount.currency.symbol}\n          </TYPE.black>\n        </RowFixed>\n      </RowBetween>\n      <RowBetween>\n        <RowFixed>\n          <TYPE.black color={theme.text2} fontSize={14} fontWeight={400}>\n            Price Impact\n          </TYPE.black>\n          <QuestionHelper text=\"Since this trade is routed through Moola, there is zero price slippage.\" />\n        </RowFixed>\n        <ErrorText fontWeight={500} fontSize={14} severity={0}>\n          0.00%\n        </ErrorText>\n      </RowBetween>\n      {userDataArea}\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}